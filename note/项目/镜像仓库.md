1. 基于harbor的镜像仓库服务
2. harbor本身有账号角色体系，接入公有云的账号体系，也就是租户与iam账号，也就是每个账号可以绑定一个harbor本身的账号
3. harbor的镜像上传只支持docker或者containerd的镜像拉取上传，做了个图形化镜像切片上传
3.1 由前端将镜像文件切成固定大小的切片，每个切片都包含完整镜像包的文件大小和切片hash值和起始结束byte位置，切片文件存本地，切片上传失败前端重传，当所有切片上传完成合并文件比较文件hash，调用服务器本地的containerd import和push镜像
3.2 存在问题：一个镜像文件都会在经过在本地存储并import到containerd，这会造成服务器磁盘空间不够；二是并发对仓库服务的网络造成影响，上传速度慢甚至超时
3.3 优化策略
3.3.1 秒传：对于可能的相同文件，根据md5值相同，直接使用已有文件；根据md5的分布式锁，上传相同文件就会阻塞，后续文件也能秒传
3.3.2 响应切片上传进度：redis存切片进度，提供拉取进度接口，也知道哪些上传失败
4. 项目配额：harbor每个project可以设置空间大小